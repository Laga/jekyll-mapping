<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640" />

    <link rel="stylesheet" href="/jekyll-mapping/stylesheets/core.css" media="screen"/>
    <link rel="stylesheet" href="/jekyll-mapping/stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)"/>
    <link rel="stylesheet" href="/jekyll-mapping/stylesheets/pygment_trac.css"/>

    <script type="text/javascript" src="/jekyll-mapping/javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="/jekyll-mapping/javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>Jekyll-mapping by matthewowen</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/matthewowen/jekyll-mapping">View on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>Jekyll-mapping</h1>
            <h2>Easily embed maps on Jekyll sites, with support for Google Maps and OpenStreetMap</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/matthewowen/jekyll-mapping/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/matthewowen/jekyll-mapping/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>


      <span class="banner-fix"></span>


      <section id="main_content">
        <ul>
        
            <h2><a href="/2012/07/15/post-with-location.html">A post with a location</a></h2>
        
            <h2><a href="/2012/07/15/multiple-locations.html">A post with multiple locations</a></h2>
        
            <h2><a href="/2012/07/15/kml-layer.html">A post with a KML layer</a></h2>
        
        </ul>
        <h1 id='jekyll_mapping'>Jekyll Mapping</h1>

<p>Jekyll mapping is a plugin for Jekyll that takes away the pain of using Google Maps and OpenStreetMap on your site. Here are some of the things it makes it easy to do:</p>

<ul>
<li>Give each piece of content a location, allowing you to. This means you can show a map on each piece of content, showing its location, but also lets you show all of your site&#8217;s content on a map, like this: <div style='height:350px;width:500px;' id='jekyll-mapping' /> <script type='text/javascript'>
                      window.onload = function () { jekyllMapping.loadScript({"pages":[{"longitude":32,"link":"/jekyll-mapping//2012/07/15/multiple-locations.html","latitude":-14,"title":"A post with multiple locations"},{"longitude":10,"link":"/jekyll-mapping//2012/07/15/post-with-location.html","latitude":10,"title":"A post with a location"}],"api_key":"AIzaSyDNhj22EqZoDYXSF90FMCQjS-nQx4JG4uI","provider":"google_js","zoom":10,"dimensions":{"height":350,"width":500}}) };
                  </script></li>

<li>Set multiple locations on a single piece of content and map them all (perfect if you want a map showing all of your company&#8217;s offices): <a href='/jekyll-mapping/multiple-locations'>see an example</a></li>

<li>Set a KML layer (or multiple KML layers) on a piece of content and display on a map. This one offers a world of possibilities: data overlays, directions or routes, up to the minute data from a continually updating feed: <a href='/jekyll-mapping/kml-layer'>see an example</a></li>
</ul>

<h2 id='supported_providers'>Supported providers</h2>

<h3 id='google_static_image'>Google static image</h3>

<pre><code>mapping:
    provider: google_static</code></pre>

<p>https://developers.google.com/maps/documentation/staticmaps/</p>

<p>Embeds a static image, centered on the specifced location, with a marker at the specified location. This provider doesn&#8217;t have as much flexibilitity, but it&#8217;s easy to set up</p>

<h3 id='google_js_api'>Google JS API</h3>

<pre><code>mapping:
    provider: google_js</code></pre>

<p>https://developers.google.com/maps/documentation/javascript/</p>

<p>Embeds an interactive map using the V3 JS API. Using this requires an API key to be specified within <em>config.yml (and you&#8217;ll face usage limits if you don&#8217;t want to pay money)</em></p>

<h3 id='openstreetmap'>OpenStreetMap</h3>

<pre><code>mapping:
    provider: openstreetmap</code></pre>

<p>Uses <a href='http://www.openstreetmap.org/'>OpenStreetMap</a> and <a href='http://openlayers.org/'>OpenLayers</a> to provide interactive maps. Doesn&#8217;t require an API key, and doesn&#8217;t come with usage limits (but use it responsibly)</p>

<h2 id='basic_usage'>Basic usage</h2>

<p>To use, include configuration information in <em>config.yml. At minimum, specify a provider:</em></p>

<pre><code>mapping:
    provider: google_static</code></pre>

<p>If desired, set default dimensions for maps and a custom zoom level (the default zoom level is 10):</p>

<pre><code>mapping:
    provider: openstreetmap
    zoom: 8
    dimensions:
        width: 600
        height: 400</code></pre>

<p>If using Google JS API, include an API key:</p>

<pre><code>mapping:
    provider: google_js
    api_key: 123456
    zoom: 10
    dimensions:
        width: 600
        height: 400</code></pre>

<p>Put the contents of &#8216;_includes&#8217; in your &#8216;_includes&#8217; directory and the contents of &#8216;_plugins&#8217; in your &#8216;_plugins&#8217; directory (or just copy the directories if you don&#8217;t have those directories yet).</p>

<p>Set the relevant values in the YAML front matter of pages and posts:</p>

<pre><code>mapping:
    latitude: 51.101
    longitude: 0.1</code></pre>

<p>Include the render_map tag in your templates where you&#8217;d like the map to appear:</p>

<pre><code>{% render_map %}</code></pre>

<p>Optionally, specify the width for the map here:</p>

<pre><code>{% render_map 500,500 %}</code></pre>

<p>Include the required JavaScript at the foot of your templates:</p>

<pre><code>{% include jekyll_mapping.html %}
&lt;/body&gt;</code></pre>

<p>You don&#8217;t need to wrap the above in any if statements - jekyll-mapping won&#8217;t output anything if it isn&#8217;t supposed to.</p>

<p>Enjoy!</p>

<h2 id='further_usage'>Further usage</h2>

<p>At it&#8217;s most basic, you can just set a latitude and longitude for a piece of content. In this case, it&#8217;ll just plot that location on a map. However, you can do some other exciting things too!</p>

<h3 id='multiple_locations'>Multiple Locations</h3>

<p>If you set multiple locations, they&#8217;ll all be mapped and the map will be zoomed and panned to fit them. You can even set a link on them (and have them link to content). Use like so:</p>

<pre><code>mapping:
    locations:
        - title: foo
          latitude: 10
          longitude: 10
        - title: bar
          link: /some/awesome/path
          latitude: -10
          longitude: -10</code></pre>

<h3 id='kml'>KML</h3>

<p>If you&#8217;d like to use KML, you can do that too. Just add &#8216;layers&#8217; in a similar fashion:</p>

<pre><code>mapping:
    layers:
        - http://api.flickr.com/services/feeds/geo/?g=322338@N20&amp;lang=en-us&amp;format=feed-georss
        - http://gmaps-samples.googlecode.com/svn/trunk/ggeoxml/cta.kml</code></pre>

<p>Right now, multiple locations works for both google_js and openstreetmap. KML definitely works for google_js and should work for openstreetmap, but needs more testing.</p>

<h3 id='listing_content'>Listing content</h3>

<p>Use the following tag instead of {% render_map %}:</p>

<pre><code>{% render_index_map %}</code></pre>

<p>This will plot a marker for every post on the site which has a latitude and longitude. Clicking on the marker will take you to the piece of content</p>

<p>Add configuration like so</p>

<pre><code>{% render_index_map 400,400:foo,bar %}</code></pre>

<p>This will render a 400x400 map, and only list posts from the categories &#8216;foo&#8217; and &#8216;bar&#8217;.</p>

<pre><code>{% render_index_map :foo,bar %}</code></pre>

<p>This will render a map at the default size, listing posts from the categories &#8216;foo&#8217; and &#8216;bar&#8217;</p>

<pre><code>{% render_index_map 400,400: %}</code></pre>

<p>This will render a 400x400 map, listing posts from all categories.</p>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/matthewowen">matthewowen</a> can be found on <a href="https://github.com/matthewowen/jekyll-mapping">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="http://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>
    
    
            <script type="text/javascript">
var jekyllMapping = (function () {
    'use strict';
    var settings;
    return {
        plotArray: function(locations) {
            function jekyllMapListen (m, s) {
                if (s.link) {
                    google.maps.event.addListener(m, 'click', function() {
                        window.location.href = s.link;
                    });
                }
            }
            var bounds = new google.maps.LatLngBounds(), markers = [], s, l, m;
            while (locations.length > 0) {
                s = locations.pop();
                console.log(s);
                l = new google.maps.LatLng(s.latitude, s.longitude);
                m = new google.maps.Marker({
                    position: l,
                    map: this.map,
                    title: s.title
                });
                markers.push(m);
                bounds.extend(l);                
                jekyllMapListen(m, s);
            }
            this.map.fitBounds(bounds);
        },
        indexMap: function () {
            this.plotArray(settings.pages);
        },
        pageToMap: function () {
            if (typeof(settings.latitude) !== 'undefined' && typeof(settings.longitude) !== 'undefined') {
                this.options.center = new google.maps.LatLng(settings.latitude, settings.longitude);

                var mainMarker = new google.maps.Marker({
                    position: this.options.center,
                    map: this.map,
                    title: ""
                });
                this.map.setCenter(this.options.center);
            }     

            if (settings.locations instanceof Array) {
                this.plotArray(settings.locations);
            }

            if (settings.kml) {
                var mainLayer = new google.maps.KmlLayer(settings.kml);
                mainLayer.setMap(this.map);
            }
            
            if (settings.layers) {
                var layers = [];
                while (settings.layers.length > 0){
                    var m = new google.maps.KmlLayer(settings.layers.pop());
                    layers.push(m);
                    m.setMap(this.map);
                }
            }
        },
        mappingInitialize: function () {
            this.options = {
                zoom: 10,
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                center: new google.maps.LatLng(0, 0)
            };

            this.map = new google.maps.Map(document.getElementById("jekyll-mapping"), this.options);

            if (settings.pages) {
                this.indexMap();
            } else {
                this.pageToMap();
            }
        },
        loadScript: function (set) {
            settings = set;
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src = "http://maps.googleapis.com/maps/api/js?key=" + settings.api_key + "&sensor=false&callback=jekyllMapping.mappingInitialize";
            document.body.appendChild(script);
        }
    };
}());
</script> 
        
    

  </body>
</html>
